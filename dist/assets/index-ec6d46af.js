var St=Object.defineProperty;var kt=(o,s,t)=>s in o?St(o,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[s]=t;var l=(o,s,t)=>(kt(o,typeof s!="symbol"?s+"":s,t),t);(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))e(i);new MutationObserver(i=>{for(const n of i)if(n.type==="childList")for(const r of n.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&e(r)}).observe(document,{childList:!0,subtree:!0});function t(i){const n={};return i.integrity&&(n.integrity=i.integrity),i.referrerPolicy&&(n.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?n.credentials="include":i.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function e(i){if(i.ep)return;i.ep=!0;const n=t(i);fetch(i.href,n)}})();const tt=navigator.userAgent.toLowerCase(),Rt=tt.includes("chrome"),jt=!Rt&&tt.includes("safari"),It=typeof orientation<"u"||tt.includes("mobile"),et=!!window.PointerEvent,it="ontouchstart"in window||!!window.TouchEvent,st=it||et,X=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1;navigator.platform.startsWith("Mac");navigator.platform.startsWith("Linux");let Ft=0;function v(o){return typeof o._leaflet_id!="number"&&(o._leaflet_id=++Ft),o._leaflet_id}function Nt(o,s,t){let e=!1,i;function n(){e=!1,i&&(r.apply(t,i),i=void 0)}function r(...a){e?i=a:(o.apply(t,a),setTimeout(n,s),e=!0)}return r}function F(o,s,t){const e=s[1],i=s[0],n=e-i;return o===e&&t?o:((o-i)%n+n)%n+i}function w(){return!1}function N(o,s){if(s===!1)return o;const t=Math.pow(10,s===void 0?6:s);return Math.round(o*t)/t}function E(o){return o.trim().split(/\s+/)}function b(o,s,t){return Object.hasOwn(o,"options")||(o.options=o.options?Object.create(o.options):{}),Object.assign(o.options,t,s)}const Dt=/\{ *([\w_ -]+) *\}/g;function Wt(o,s){return o.replace(Dt,(t,e)=>{let i=s[e];if(i===void 0)throw new Error(`No value provided for variable ${t}`);return typeof i=="function"&&(i=i(s)),i})}const q="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";class nt{constructor(){l(this,"_events",Object.create(null));l(this,"_parents")}on(s,t,e,i){if(typeof s=="string")for(const n of E(s))this._on(n,t,e,i);else for(const[n,r]of Object.entries(s))this._on(n,r,t,e);return this}off(s,t,e){if(s===void 0)this._events=Object.create(null);else if(typeof s=="object")for(const[i,n]of Object.entries(s))this._off(i,n,t);else for(const i of E(s))this._off(i,t,e);return this}_on(s,t,e,i){var n;this._indexOfHandler(s,t,e)>=0||(e===this&&(e=void 0),((n=this._events)[s]||(n[s]=[])).push([t,e,!!i]))}_off(s,t,e){const i=this._events[s];if(!i)return;if(!t){delete this._events[s];return}const n=this._indexOfHandler(s,t,e);n>=0&&(i.length===1?(i.length=0,delete this._events[s]):i.splice(n,1))}fire(s,t,e){const i={...t,type:s,target:this,sourceTarget:(t==null?void 0:t.sourceTarget)||this},n=this._events[s];if(n){for(let r=0;r<n.length;r++){const[a,h,d]=n[r];d&&(n.splice(r,1),--r),a.call(h||this,i)}n.length||delete this._events[s]}if(e&&this._parents)for(const r of this._parents)r.fire(i.type,{layer:i.target,propagatedFrom:i.target,...i},!0);return this}listens(s,t,e,i){var n;if(typeof t!="function"){if((n=this._events[s])!=null&&n.length)return!0;i=t,t=void 0}else if(this._indexOfHandler(s,t,e)>=0)return!0;if(i&&this._parents){for(const r of this._parents)if(r.listens(s,t,e,!0))return!0}return!1}_indexOfHandler(s,t,e){const i=this._events[s];if(i){e===this&&(e=void 0);for(let n=0;n<i.length;n++){const r=i[n];if(r[0]===t&&r[1]===e)return n}}return-1}addEventParent(s){(this._parents||(this._parents=[])).push(s)}removeEventParent(s){var e;const t=(e=this._parents)==null?void 0:e.indexOf(s);typeof t=="number"&&this._parents.splice(t,1)}}class c{constructor(s,t,e){l(this,"x");l(this,"y");l(this,"z");l(this,"distance");this.x=e?Math.round(s):s,this.y=e?Math.round(t):t}clone(){return new c(this.x,this.y)}add(s){return this.clone()._add(s)}_add(s){return this.x+=s.x,this.y+=s.y,this}subtract(s){return this.clone()._subtract(s)}_subtract(s){return this.x-=s.x,this.y-=s.y,this}divideBy(s){return this.clone()._divideBy(s)}_divideBy(s){return this.x/=s,this.y/=s,this}multiplyBy(s){return this.clone()._multiplyBy(s)}_multiplyBy(s){return this.x*=s,this.y*=s,this}scaleBy(s){return new c(this.x*s.x,this.y*s.y)}unscaleBy(s){return new c(this.x/s.x,this.y/s.y)}round(){return this.clone()._round()}_round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}floor(){return this.clone()._floor()}_floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.clone()._ceil()}_ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}trunc(){return this.clone()._trunc()}_trunc(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}distanceTo(s){const t=s.x-this.x,e=s.y-this.y;return Math.sqrt(t*t+e*e)}equals(s){return s.x===this.x&&s.y===this.y}contains(s){return Math.abs(s.x)<=Math.abs(this.x)&&Math.abs(s.y)<=Math.abs(this.y)}toString(){return`Point(${N(this.x)}, ${N(this.y)})`}}class g{constructor(...s){l(this,"min");l(this,"max");for(let t=0,e=s.length;t<e;t++)this.extend(s[t])}extend(s){let t,e;return s instanceof c?t=e=s:(t=s.min,e=s.max),!this.min&&!this.max?(this.min=t.clone(),this.max=e.clone()):(this.min.x=Math.min(t.x,this.min.x),this.max.x=Math.max(e.x,this.max.x),this.min.y=Math.min(t.y,this.min.y),this.max.y=Math.max(e.y,this.max.y)),this}getCenter(s){return new c((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,s)}getBottomLeft(){return new c(this.min.x,this.max.y)}getTopRight(){return new c(this.max.x,this.min.y)}getTopLeft(){return this.min}getBottomRight(){return this.max}getSize(){return this.max.subtract(this.min)}contains(s){let t,e;return s instanceof g?(t=s.min,e=s.max):t=e=s,t.x>=this.min.x&&e.x<=this.max.x&&t.y>=this.min.y&&e.y<=this.max.y}intersects(s){const t=this.min,e=this.max,i=s.min,n=s.max,r=n.x>=t.x&&i.x<=e.x,a=n.y>=t.y&&i.y<=e.y;return r&&a}overlaps(s){const t=this.min,e=this.max,i=s.min,n=s.max,r=n.x>t.x&&i.x<e.x,a=n.y>t.y&&i.y<e.y;return r&&a}isValid(){return!!(this.min&&this.max)}pad(s){const t=this.min,e=this.max,i=Math.abs(t.x-e.x)*s,n=Math.abs(t.y-e.y)*s;return new g(new c(t.x-i,t.y-n),new c(e.x+i,e.y+n))}equals(s){return this.min.equals(s.min)&&this.max.equals(s.max)}}class qt{constructor(s,t,e,i){this._a=s,this._b=t,this._c=e,this._d=i}transform(s,t){return this._transform(s.clone(),t)}_transform(s,t){return t||(t=1),s.x=t*(this._a*s.x+this._b),s.y=t*(this._c*s.y+this._d),s}untransform(s,t){return t||(t=1),new c((s.x/t-this._b)/this._a,(s.y/t-this._d)/this._c)}}function $t(o){if(o.composedPath)return o.composedPath();const s=[];let t=o.target;for(;t;)s.push(t),t=t.parentNode;return s}function Vt(o){let s={bubbles:o.bubbles,cancelable:o.cancelable,composed:o.composed,detail:2,view:o.view,screenX:o.screenX,screenY:o.screenY,clientX:o.clientX,clientY:o.clientY,ctrlKey:o.ctrlKey,shiftKey:o.shiftKey,altKey:o.altKey,metaKey:o.metaKey,button:o.button,buttons:o.buttons,relatedTarget:o.relatedTarget,region:o.region},t;return o instanceof PointerEvent?(s={...s,pointerId:o.pointerId,width:o.width,height:o.height,pressure:o.pressure,tangentialPressure:o.tangentialPressure,tiltX:o.tiltX,tiltY:o.tiltY,twist:o.twist,pointerType:o.pointerType,isPrimary:o.isPrimary},t=new PointerEvent("dblclick",s)):t=new MouseEvent("dblclick",s),t}const Ht=200;function Ut(o,s){o.addEventListener("dblclick",s);let t=0,e;function i(n){if(n.detail!==1){e=n.detail;return}if(n.pointerType==="mouse"||n.sourceCapabilities&&!n.sourceCapabilities.firesTouchEvents)return;const r=$t(n);if(r.some(h=>h instanceof HTMLLabelElement&&h.attributes.for)&&!r.some(h=>h instanceof HTMLInputElement||h instanceof HTMLSelectElement))return;const a=Date.now();a-t<=Ht?(e++,e===2&&n.target.dispatchEvent(Vt(n))):e=1,t=a}return o.addEventListener("click",i),{dblclick:s,simDblclick:i}}function Xt(o,s){o.removeEventListener("dblclick",s.dblclick),o.removeEventListener("click",s.simDblclick)}const Y={touchstart:"pointerdown",touchmove:"pointermove",touchend:"pointerup",touchcancel:"pointercancel"},dt={touchstart:R,touchmove:R,touchend:R,touchcancel:R},Z={};let ct=!1;function Yt(o,s,t){return s==="touchstart"&&Qt(),dt[s]?(t=dt[s].bind(this,t),o.addEventListener(Y[s],t,!1),t):(console.warn("wrong event specified:",s),w)}function Gt(o,s,t){if(!Y[s]){console.warn("wrong event specified:",s);return}o.removeEventListener(Y[s],t,!1)}function Kt(o){Z[o.pointerId]=o}function Jt(o){Z[o.pointerId]&&(Z[o.pointerId]=o)}function ut(o){delete Z[o.pointerId]}function Qt(){ct||(document.addEventListener("pointerdown",Kt,!0),document.addEventListener("pointermove",Jt,!0),document.addEventListener("pointerup",ut,!0),document.addEventListener("pointercancel",ut,!0),ct=!0)}function R(o,s){if(s.pointerType!=="mouse"){s.touches=[];for(const t of Object.values(Z))s.touches.push(t);s.changedTouches=[s],o(s)}}function te(o){const s=o.getBoundingClientRect();return{x:s.width/o.offsetWidth||1,y:s.height/o.offsetHeight||1,boundingClientRect:s}}function x(o,s,t,e){if(typeof s=="object")for(const[i,n]of Object.entries(s))mt(o,i,n,t);else for(const i of E(s))mt(o,i,t,e);return this}const T="_leaflet_events";function gt(o,s,t,e){if(!s)_t(o),delete o[T];else if(typeof s=="object")for(const[i,n]of Object.entries(s))K(o,i,n,t);else if(arguments.length===2){const i=new Set(E(s));_t(o,n=>i.has(n))}else for(const i of E(s))K(o,i,t,e);return this}function _t(o,s){const t=o[T];if(t)for(const e of Object.keys(t)){const i=e.split(/\d/)[0];(!s||s(i))&&K(o,i,w,null,e)}}const G={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function vt(o,s,t){return o+v(s)+(t?`_${v(t)}`:"")}function mt(o,s,t,e){var a;const i=vt(s,t,e);if((a=o[T])!=null&&a[i])return;let n=function(h){return t.call(e||o,h||window.event)};const r=n;!it&&et&&s.startsWith("touch")?n=Yt(o,s,n):st&&s==="dblclick"?n=Ut(o,n):s==="touchstart"||s==="touchmove"||s==="wheel"||s==="mousewheel"?o.addEventListener(G[s]||s,n,{passive:!1}):s==="mouseenter"||s==="mouseleave"?(n=function(h){h=h||window.event,o instanceof Node&&yt(o,h)&&r(h)},o.addEventListener(G[s],n,!1)):o.addEventListener(s,r,!1),o[T]||(o[T]={}),o[T][i]=n}function K(o,s,t,e,i=vt(s,t,e)){const n=o[T]&&o[T][i];n&&(!it&&et&&s.startsWith("touch")?Gt(o,s,n):st&&s==="dblclick"?Xt(o,n):o.removeEventListener(G[s]||s,n,!1),delete o[T][i])}function ee(o){return o.preventDefault?o.preventDefault():o.returnValue=!1,this}function ie(o,s){if(!s)return new c(o.clientX,o.clientY);const t=te(s),e=t.boundingClientRect;return new c((o.clientX-e.left)/t.x-s.clientLeft,(o.clientY-e.top)/t.y-s.clientTop)}function yt(o,s){let t=s.relatedTarget;if(!t)return!0;try{for(;t&&t!==o;)t=t.parentNode}catch{return!1}return t!==o}function C(o,s,t){const e=document.createElement(o);return s&&(e.className=s),t&&t.appendChild(e),e}function ot(o){const s=o.parentNode;s&&s.lastChild!==o&&s.appendChild(o)}function rt(o){const s=o.parentNode;s&&s.firstChild!==o&&s.insertBefore(o,s.firstChild)}function B(o,s,t){const{x:e,y:i}=s||new c(0,0);o.style.transform=`translate3d(${e}px,${i}px,0)${typeof t=="number"?` scale(${t})`:""}`}const wt=new WeakMap;function A(o,s){wt.set(o,s),B(o,s)}function xt(o){return wt.get(o)??new c(0,0)}document.documentElement.style;let I,J;function se(o){for(;o.tabIndex===-1&&o.parentNode;)o=o.parentNode;o.style&&(Q(),I=o,J=o.style.outlineStyle,o.style.outlineStyle="none",x(window,"keydown",Q))}function Q(){I&&(I.style.outlineStyle=J,I=void 0,J=void 0,gt(window,"keydown",Q))}class ne extends nt{constructor(){super(...arguments);l(this,"_inProgress",!1);l(this,"_el");l(this,"_duration",.25);l(this,"_easeOutPower",2);l(this,"_startPos");l(this,"_offset");l(this,"_startTime",0);l(this,"_animFrame",0)}run(t,e,i=.25,n){this.stop(),this._el=t,this._inProgress=!0,this._duration=i,this._easeOutPower=1/Math.max(n||.5,.2),this._startPos=xt(t),this._offset=e.subtract(this._startPos),this._startTime=Date.now(),this.fire("start"),this._animate()}stop(){this._inProgress&&(this._step(!0),this._complete())}_animate(){this._animFrame=requestAnimationFrame(()=>this._animate()),this._step()}_step(t){const e=Date.now()-this._startTime,i=this._duration*1e3;e<i?this._runFrame(this._easeOut(e/i),t):(this._runFrame(1),this._complete())}_runFrame(t,e){const i=this._startPos.add(this._offset.multiplyBy(t));e&&i._round(),A(this._el,i),this.fire("step")}_complete(){cancelAnimationFrame(this._animFrame),this._inProgress=!1,this.fire("end")}_easeOut(t){return 1-Math.pow(1-t,this._easeOutPower)}}class f{constructor(s,t,e=void 0){this.lat=s,this.lng=t,this.alt=e}equals(s,t=1e-9){return Math.max(Math.abs(this.lat-s.lat),Math.abs(this.lng-s.lng))<=t}clone(){return new f(this.lat,this.lng,this.alt)}toString(s){return`LatLng(${N(this.lat,s)}, ${N(this.lng,s)})`}}class L{constructor(...s){l(this,"_southWest");l(this,"_northEast");for(let t=0,e=s.length;t<e;t++)this.extend(s[t])}static fromCenter(s,t){const e=180*t/40075017,i=e/Math.cos(Math.PI/180*s.lat);return new L(new f(s.lat-e,s.lng-i),new f(s.lat+e,s.lng+i))}extend(s){const t=this._southWest,e=this._northEast;let i,n;if(s instanceof f)i=s,n=s;else if(s instanceof L){if(i=s._southWest,n=s._northEast,!i||!n)return this}else return this;return!t||!e?(this._southWest=new f(i.lat,i.lng),this._northEast=new f(n.lat,n.lng)):(t.lat=Math.min(i.lat,t.lat),t.lng=Math.min(i.lng,t.lng),e.lat=Math.max(n.lat,e.lat),e.lng=Math.max(n.lng,e.lng)),this}pad(s){const t=this._southWest,e=this._northEast,i=Math.abs(t.lat-e.lat)*s,n=Math.abs(t.lng-e.lng)*s;return new L(new f(t.lat-i,t.lng-n),new f(e.lat+i,e.lng+n))}getCenter(){return new f((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)}getSouthWest(){return this._southWest}getNorthEast(){return this._northEast}getNorthWest(){return new f(this.getNorth(),this.getWest())}getSouthEast(){return new f(this.getSouth(),this.getEast())}getWest(){return this._southWest.lng}getSouth(){return this._southWest.lat}getEast(){return this._northEast.lng}getNorth(){return this._northEast.lat}contains(s){const t=this._southWest,e=this._northEast;let i,n;return s instanceof L?(i=s._southWest,n=s._northEast):i=n=s,i.lat>=t.lat&&n.lat<=e.lat&&i.lng>=t.lng&&n.lng<=e.lng}intersects(s){const t=this._southWest,e=this._northEast,i=s.getSouthWest(),n=s.getNorthEast(),r=n.lat>=t.lat&&i.lat<=e.lat,a=n.lng>=t.lng&&i.lng<=e.lng;return r&&a}overlaps(s){const t=this._southWest,e=this._northEast,i=s.getSouthWest(),n=s.getNorthEast(),r=n.lat>t.lat&&i.lat<e.lat,a=n.lng>t.lng&&i.lng<e.lng;return r&&a}toBBoxString(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")}equals(s,t){return s?this._southWest.equals(s._southWest,t)&&this._northEast.equals(s._northEast,t):!1}isValid(){return!!(this._southWest&&this._northEast)}}class $ extends D{constructor(t,e){super();l(this,"_layers",{});b(this,e);let i,n;if(t)for(i=0,n=t.length;i<n;i++)this.addLayer(t[i])}addLayer(t){const e=this.getLayerId(t);return this._layers[e]=t,this._map&&this._map.addLayer(t),this}removeLayer(t){const e=typeof t=="number"?t:this.getLayerId(t);return this._map&&this._layers[e]&&this._map.removeLayer(this._layers[e]),delete this._layers[e],this}hasLayer(t){return(typeof t=="number"?t:this.getLayerId(t))in this._layers}clearLayers(){return this.eachLayer(this.removeLayer,this)}invoke(t,...e){var i;for(const n of Object.values(this._layers))(i=n[t])==null||i.apply(n,e);return this}onAdd(t){return this.eachLayer(t.addLayer,t)}onRemove(t){this.eachLayer(t.removeLayer,t)}eachLayer(t,e){for(const i of Object.values(this._layers))t.call(e,i);return this}getLayer(t){return this._layers[t]}getLayers(){return Object.values(this._layers)}setZIndex(t){return this.invoke("setZIndex",t)}getLayerId(t){return v(t)}}class Tt extends ${addLayer(s){return this.hasLayer(s)?this:(s.addEventParent(this),$.prototype.addLayer.call(this,s),this.fire("layeradd",{layer:s}))}removeLayer(s){return this.hasLayer(s)?(s in this._layers&&(s=this._layers[s]),s.removeEventParent(this),$.prototype.removeLayer.call(this,s),this.fire("layerremove",{layer:s})):this}setStyle(s){return this.invoke("setStyle",s)}bringToFront(){return this.invoke("bringToFront")}bringToBack(){return this.invoke("bringToBack")}getBounds(){const s=new L;for(const t of Object.values(this._layers))t.getBounds?s.extend(t.getBounds()):t.getLatLng&&s.extend(t.getLatLng());return s}}class j extends D{constructor(t,e){super();l(this,"_latlng");l(this,"_source");l(this,"_content");l(this,"_container");l(this,"_contentNode");l(this,"_removeTimeout");const i={interactive:!1,offset:new c(0,0),className:"",pane:void 0,content:""};t instanceof f?(this._latlng=t,b(this,e,i)):(b(this,t,i),this._source=e),this.options.content&&(this._content=this.options.content)}openOn(t=this._source._map){return t.hasLayer(this)||t.addLayer(this),this}close(){return this._map&&this._map.removeLayer(this),this}toggle(t){return this._map?this.close():(t?this._source=t:t=this._source,this._prepareOpen(),this.openOn(t._map)),this}onAdd(t){return this._zoomAnimated=t._zoomAnimated,this._container||this._initLayout(),t.options.fadeAnimation&&(this._container.style.opacity=0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),t.options.fadeAnimation&&(this._container.style.opacity=1),this.bringToFront(),this.options.interactive&&(this._container.classList.add("leaflet-interactive"),this.addInteractiveTarget(this._container)),this}onRemove(t){t.options.fadeAnimation?(this._container.style.opacity=0,this._removeTimeout=setTimeout(()=>this._container.remove(),200)):this._container.remove(),this.options.interactive&&(this._container.classList.remove("leaflet-interactive"),this.removeInteractiveTarget(this._container))}getLatLng(){return this._latlng}setLatLng(t){return this._latlng=t,this._map&&(this._updatePosition(),this._adjustPan()),this}getContent(){return this._content}setContent(t){return this._content=t,this.update(),this}getElement(){return this._container}update(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())}getEvents(){const t={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t}isOpen(){return!!this._map&&this._map.hasLayer(this)}bringToFront(){return this._map&&ot(this._container),this}bringToBack(){return this._map&&rt(this._container),this}_prepareOpen(t){let e=this._source;if(!e._map)return!1;if(e instanceof Tt){e=null;const i=this._source._layers;for(const n in i)if(i[n]._map){e=i[n];break}if(!e)return!1;this._source=e}if(!t)if(e.getCenter)t=e.getCenter();else if(e.getLatLng)t=e.getLatLng();else if(e.getBounds)t=e.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(t),this._map&&this.update(),!0}_updateContent(){if(!this._content)return;const t=this._contentNode,e=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof e=="string")t.innerHTML=e;else{for(;t.hasChildNodes();)t.removeChild(t.firstChild);t.appendChild(e)}this.fire("contentupdate")}_getAnchor(){return new c(0,0)}}class oe extends j{constructor(s,t){super(s,t),b(this,!(s instanceof f)&&s||t,{pane:"tooltip",offset:new c(0,0),direction:"auto",permanent:!1,sticky:!1,opacity:.9})}onAdd(s){return j.prototype.onAdd.call(this,s),this.setOpacity(this.options.opacity),s.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0)),this}onRemove(s){j.prototype.onRemove.call(this,s),s.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))}getEvents(){const s=j.prototype.getEvents.call(this);return this.options.permanent||(s.preclick=this.close),s}_initLayout(){const s="leaflet-tooltip",t=`${s} ${this.options.className||""} leaflet-zoom-${this._zoomAnimated?"animated":"hide"}`;this._contentNode=this._container=C("div",t),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id",`leaflet-tooltip-${v(this)}`)}_updateLayout(){}_adjustPan(){}_setPosition(s){let t,e,i=this.options.direction;const n=this._map,r=this._container,a=n.latLngToContainerPoint(n.getCenter()),h=n.layerPointToContainerPoint(s),d=r.offsetWidth,u=r.offsetHeight,m=this.options.offset,_=this._getAnchor();i==="top"?(t=d/2,e=u):i==="bottom"?(t=d/2,e=0):i==="center"?(t=d/2,e=u/2):i==="right"?(t=0,e=u/2):i==="left"?(t=d,e=u/2):h.x<a.x?(i="right",t=0,e=u/2):(i="left",t=d+(m.x+_.x)*2,e=u/2),s=s.subtract(new c(Math.round(t),Math.round(e))).add(m).add(_),r.classList.remove("leaflet-tooltip-right","leaflet-tooltip-left","leaflet-tooltip-top","leaflet-tooltip-bottom"),r.classList.add(`leaflet-tooltip-${i}`),A(r,s)}_updatePosition(){const s=this._map.latLngToLayerPoint(this._latlng);this._setPosition(s)}setOpacity(s){this.options.opacity=s,this._container&&(this._container.style.opacity=s)}_animateZoom(s){const t=this._map._latLngToNewLayerPoint(this._latlng,s.zoom,s.center);this._setPosition(t)}_getAnchor(){var s,t;return!this.options.sticky&&((t=(s=this._source)==null?void 0:s._getTooltipAnchor)==null?void 0:t.call(s))||new c(0,0)}}const Lt={pane:"overlay",bubblingMouseEvents:!0};class D extends nt{constructor(){super(...arguments);l(this,"options",Lt);l(this,"_mapToAdd");l(this,"_map");l(this,"_zoomAnimated",!1);l(this,"_tooltip");l(this,"_tooltipHandlersAdded",!1);l(this,"_openOnceFlag",!1)}_project(){}_update(){}_reset(){}addTo(t){return t.addLayer(this),this}remove(){return this.removeFrom(this._map||this._mapToAdd)}removeFrom(t){return t&&t.removeLayer(this),this}getPane(){var t;return(t=this._map)==null?void 0:t._panes[this.options.pane]}addInteractiveTarget(t){return this._map&&(this._map._targets[v(t)]=this),this}removeInteractiveTarget(t){return this._map&&delete this._map._targets[v(t)],this}_layerAdd(t){const e=t.target;if(e.hasLayer(this)){if(this._map=e,this._zoomAnimated=e._zoomAnimated,this.getEvents){const i=this.getEvents();e.on(i,this),this.on("remove",function(){e.off(i,this)},this,!0)}this.onAdd(e),this.fire("add"),e.fire("layeradd",{layer:this})}}_initOverlay(t,e,i,n){let r=i;return r instanceof t?(b(r,n),r._source=this):(r=e&&!n?e:new t(n,this),r.setContent(i)),r}bindTooltip(t,e){return this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(oe,this._tooltip,t,e),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this}unbindTooltip(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=void 0),this}_initTooltipInteractions(t){if(!t&&this._tooltipHandlersAdded)return;const e=this._tooltip,i=t?"off":"on",n={remove:this.closeTooltip,move:this._moveTooltip};e.options.permanent?n.add=this._openTooltip:(n.mouseover=this._openTooltip,n.mouseout=this.closeTooltip,n.click=this._openTooltip,this._map?this._addFocusListeners():n.add=this._addFocusListeners),e.options.sticky&&(n.mousemove=this._moveTooltip),this[i](n),this._tooltipHandlersAdded=!t}openTooltip(t){return this._tooltip&&(this instanceof Tt||(this._tooltip._source=this),this._tooltip._prepareOpen(t)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this}closeTooltip(){return this._tooltip&&this._tooltip.close(),this}toggleTooltip(){return this._tooltip&&this._tooltip.toggle(this),this}isTooltipOpen(){return!!this._tooltip&&this._tooltip.isOpen()}setTooltipContent(t){return this._tooltip&&this._tooltip.setContent(t),this}getTooltip(){return this._tooltip}_addFocusListeners(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)}_addFocusListenersOnLayer(t){const e=typeof t.getElement=="function"&&t.getElement();e&&(x(e,"focus",function(){this._tooltip._source=t,this.openTooltip()},this),x(e,"blur",this.closeTooltip,this))}_setAriaDescribedByOnLayer(t){var i;const e=(i=t.getElement)==null?void 0:i.call(t);e&&e.setAttribute("aria-describedby",this._tooltip._container.id)}_openTooltip(t){var e;if(!(!this._tooltip||!this._map)){if((e=this._map.dragging)!=null&&e.moving()&&!this._openOnceFlag){this._openOnceFlag=!0,this._map.on("moveend",()=>{this._openOnceFlag=!1,this._openTooltip(t)},this,!0);return}this._tooltip._source=t.layer||t.target,this.openTooltip(this._tooltip.options.sticky?t.latlng:void 0)}}_moveTooltip(t){const e=this._map,i=this._tooltip;let n=t.latlng;if(i.options.sticky&&t.originalEvent){const r=e.mouseEventToContainerPoint(t.originalEvent),a=e.containerPointToLayerPoint(r);n=e.layerPointToLatLng(a)}i.setLatLng(n)}}class V extends D{constructor(t){super();l(this,"_container");l(this,"_bounds");l(this,"_center");l(this,"_zoom");b(this,t,{padding:.1,continuous:!1})}onAdd(t){return this._container||(this._initContainer(),this._container.classList.add("leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._resizeContainer(),this._onMoveEnd(),this}onRemove(){this._destroyContainer()}getEvents(){const t={viewreset:this._reset,zoom:this._onZoom,moveend:this._onMoveEnd,zoomend:this._onZoomEnd||w,resize:this._resizeContainer};return this._zoomAnimated&&(t.zoomanim=this._onAnimZoom),this.options.continuous&&(t.move=this._onMoveEnd),t}_onAnimZoom(t){this._updateTransform(t.center,t.zoom)}_onZoom(){this._updateTransform(this._map.getCenter(),this._map._zoom)}_updateTransform(t,e){const i=this._map,n=i.getZoomScale(e,this._zoom),r=i.getSize().multiplyBy(.5+this.options.padding),a=i.project(this._center,e),h=r.multiplyBy(-n).add(a).subtract(i._getNewPixelOrigin(t,e));B(this._container,h,n)}_onMoveEnd(){const t=this._map,e=this.options.padding,i=t.getSize(),n=t.containerPointToLayerPoint(i.multiplyBy(-e)).round();this._bounds=new g(n,n.add(i.multiplyBy(1+e*2)).round()),this._center=t.getCenter(),this._zoom=t._zoom,this._updateTransform(this._center,this._zoom),this._onSettled()}_reset(){var t;this._onSettled(),this._updateTransform(this._center,this._zoom),(t=this._onViewReset)==null||t.call(this)}_initContainer(){this._container=C("div")}_destroyContainer(){this._container&&(gt(this._container),this._container.remove(),this._container=void 0)}_resizeContainer(){const t=this.options.padding,e=this._map.getSize().multiplyBy(1+t*2).round();return this._container.style.width=`${e.x}px`,this._container.style.height=`${e.y}px`,e}}new g(new c(-180,-90),new c(180,90));new g(new c(-2003750834279e-5,-1549657073972e-5),new c(2003750834279e-5,1876465623138e-5));const ft=6378137,pt={R:ft,MAX_LATITUDE:85.0511287798,bounds:function(){const o=ft*Math.PI;return new g(new c(-o,-o),new c(o,o))}(),project(o){const s=Math.PI/180,t=this.MAX_LATITUDE,e=Math.max(Math.min(t,o.lat),-t),i=Math.sin(e*s);return new c(this.R*o.lng*s,this.R*Math.log((1+i)/(1-i))/2)},unproject(o){const s=180/Math.PI;return new f((2*Math.atan(Math.exp(o.y/this.R))-Math.PI/2)*s,o.x*s/this.R)}},re={infinite:!1,latLngToPoint(o,s){const t=this.projection.project(o),e=this.scale(s);return this.transformation._transform(t,e)},pointToLatLng(o,s){const t=this.scale(s),e=this.transformation.untransform(o,t);return this.projection.unproject(e)},project(o){return this.projection.project(o)},unproject(o){return this.projection.unproject(o)},scale(o){return 256*Math.pow(2,o)},zoom(o){return Math.log(o/256)/Math.LN2},getProjectedBounds(o){if(this.infinite)return;const s=this.projection.bounds,t=this.scale(o),e=this.transformation.transform(s.min,t),i=this.transformation.transform(s.max,t);return new g(e,i)},wrapLatLng(o){const s=this.wrapLng?F(o.lng,this.wrapLng,!0):o.lng,t=this.wrapLat?F(o.lat,this.wrapLat,!0):o.lat,e=o.alt;return new f(t,s,e)},wrapLatLngBounds(o){const s=o.getCenter(),t=this.wrapLatLng(s),e=s.lat-t.lat,i=s.lng-t.lng;if(e===0&&i===0)return o;const n=o.getSouthWest(),r=o.getNorthEast(),a=new f(n.lat-e,n.lng-i),h=new f(r.lat-e,r.lng-i);return new L(a,h)}},ae={...re,wrapLng:[-180,180],R:6371e3,distance(o,s){const t=Math.PI/180,e=o.lat*t,i=s.lat*t,n=Math.sin((s.lat-o.lat)*t/2),r=Math.sin((s.lng-o.lng)*t/2),a=n*n+Math.cos(e)*Math.cos(i)*r*r,h=2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a));return this.R*h}},Pt={...ae,code:"EPSG:3857",projection:pt,transformation:function(){const o=.5/(Math.PI*pt.R);return new qt(o,.5,-o,.5)}()};({...Pt});class P extends V{constructor(t){super(t);l(this,"_layers",{});b(this,{...t,continuous:!1}),v(this)}onAdd(t){return V.prototype.onAdd.call(this,t),this.on("update",this._updatePaths,this)}onRemove(){V.prototype.onRemove.call(this),this.off("update",this._updatePaths,this)}_onZoomEnd(){for(const t of Object.values(this._layers))t._project()}_updatePaths(){for(const t of Object.values(this._layers))t._update()}_onViewReset(){for(const t of Object.values(this._layers))t._reset()}_onSettled(){this._update()}}class he extends P{constructor(){super(...arguments);l(this,"_ctxScale",window.devicePixelRatio);l(this,"_ctx");l(this,"_redrawBounds");l(this,"_redrawFrame",0);l(this,"_postponeUpdatePaths",!1);l(this,"_drawing",!1);l(this,"_drawFirst");l(this,"_drawLast");l(this,"_hoveredLayer");l(this,"_mouseHoverThrottled",!1)}getEvents(){const t=P.prototype.getEvents.call(this);return t.viewprereset=this._onViewPreReset,t}_onViewPreReset(){this._postponeUpdatePaths=!0}onAdd(t){return P.prototype.onAdd.call(this,t),this._draw(),this}_initContainer(){const t=this._container=document.createElement("canvas");x(t,"mousemove",this._onMouseMove,this),x(t,"click dblclick mousedown mouseup contextmenu",this._onClick,this),x(t,"mouseout",this._handleMouseOut,this),t._leaflet_disable_events=!0,this._ctx=t.getContext("2d")||void 0}_destroyContainer(){cancelAnimationFrame(this._redrawFrame),this._ctx=void 0,P.prototype._destroyContainer.call(this)}_resizeContainer(){const t=this._container,e=P.prototype._resizeContainer.call(this),i=this._ctxScale;return t.width=i*e.x,t.height=i*e.y,e}_updatePaths(){if(!this._postponeUpdatePaths){this._redrawBounds=void 0;for(const t of Object.values(this._layers))t._update();this._redraw()}}_update(){if(this._map._animatingZoom&&this._bounds)return;const t=this._bounds,e=this._ctxScale;this._ctx.setTransform(e,0,0,e,-t.min.x*e,-t.min.y*e),this.fire("update")}_reset(){P.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())}_initPath(t){this._updateDashArray(t),this._layers[v(t)]=t;const e=t._order={layer:t,prev:this._drawLast,next:void 0};this._drawLast&&(this._drawLast.next=e),this._drawLast=e,this._drawFirst||(this._drawFirst=this._drawLast)}_addPath(t){this._requestRedraw(t)}_removePath(t){const e=t._order,i=e.next,n=e.prev;i?i.prev=n:this._drawLast=n,n?n.next=i:this._drawFirst=i,delete t._order,delete this._layers[v(t)],this._requestRedraw(t)}_updatePath(t){this._extendRedrawBounds(t),t._project(),t._update(),this._requestRedraw(t)}_updateStyle(t){this._updateDashArray(t),this._requestRedraw(t)}_updateDashArray(t){if(typeof t.options.dashArray=="string"){const e=t.options.dashArray.split(/[, ]+/),i=[];let n,r;for(r=0;r<e.length;r++){if(n=Number(e[r]),isNaN(n))return;i.push(n)}t.options._dashArray=i}else t.options._dashArray=t.options.dashArray}_requestRedraw(t){this._map&&(this._extendRedrawBounds(t),this._redrawFrame||(this._redrawFrame=requestAnimationFrame(()=>this._redraw())))}_extendRedrawBounds(t){if(t._pxBounds){const e=(t.options.weight||0)+1,i=new c(e,e);this._redrawBounds||(this._redrawBounds=new g),this._redrawBounds.extend(t._pxBounds.min.subtract(i)),this._redrawBounds.extend(t._pxBounds.max.add(i))}}_redraw(){this._redrawFrame=0,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=void 0}_clear(){const t=this._redrawBounds,e=this._ctx;if(t){const i=t.getSize();e.clearRect(t.min.x,t.min.y,i.x,i.y)}else e.save(),e.setTransform(1,0,0,1,0,0),e.clearRect(0,0,this._container.width,this._container.height),e.restore()}_draw(){var i;const t=this._redrawBounds,e=this._ctx;if(e.save(),t){const n=t.getSize();e.beginPath(),e.rect(t.min.x,t.min.y,n.x,n.y),e.clip()}this._drawing=!0;for(let n=this._drawFirst;n;n=n.next){const r=n.layer;(!t||(i=r._pxBounds)!=null&&i.intersects(t))&&r._updatePath()}this._drawing=!1,e.restore()}_updatePoly(t,e){if(!this._drawing)return;let i,n,r,a;const h=t._parts,d=h.length,u=this._ctx;if(d){for(u.beginPath(),i=0;i<d;i++){for(n=0,r=h[i].length;n<r;n++)a=h[i][n],u[n?"lineTo":"moveTo"](a.x,a.y);e&&u.closePath()}this._fillStroke(u,t)}}_updateCircle(t){if(!this._drawing||t._empty())return;const e=t._point,i=this._ctx,n=Math.max(Math.round(t._radius),1),r=(Math.max(Math.round(t._radiusY),1)||n)/n;r!==1&&(i.save(),i.scale(1,r)),i.beginPath(),i.arc(e.x,e.y/r,n,0,Math.PI*2,!1),r!==1&&i.restore(),this._fillStroke(i,t)}_fillStroke(t,e){const i=e.options;i.fill&&(t.globalAlpha=i.fillOpacity,t.fillStyle=i.fillColor||i.color,t.fill(i.fillRule||"evenodd")),i.stroke&&i.weight!==0&&(t.setLineDash&&t.setLineDash(i._dashArray||[]),t.globalAlpha=i.opacity,t.lineWidth=i.weight,t.strokeStyle=i.color,t.lineCap=i.lineCap,t.lineJoin=i.lineJoin,t.stroke())}_onClick(t){const e=this._map.mouseEventToLayerPoint(t);let i,n;for(let r=this._drawFirst;r;r=r.next)i=r.layer,i.options.interactive&&i._containsPoint(e)&&(!(t.type==="click"||t.type==="preclick")||!this._map._draggableMoved(i))&&(n=i);this._fireEvent(n?[n]:!1,t)}_onMouseMove(t){var i;if(!this._map||(i=this._map.dragging)!=null&&i.moving()||this._map._animatingZoom)return;const e=this._map.mouseEventToLayerPoint(t);this._handleMouseHover(t,e)}_handleMouseOut(t){const e=this._hoveredLayer;e&&(this._container.classList.remove("leaflet-interactive"),this._fireEvent([e],t,"mouseout"),this._hoveredLayer=void 0,this._mouseHoverThrottled=!1)}_handleMouseHover(t,e){if(this._mouseHoverThrottled)return;let i,n;for(let r=this._drawFirst;r;r=r.next)i=r.layer,i.options.interactive&&i._containsPoint(e)&&(n=i);n!==this._hoveredLayer&&(this._handleMouseOut(t),n&&(this._container.classList.add("leaflet-interactive"),this._fireEvent([n],t,"mouseover"),this._hoveredLayer=n)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,t),this._mouseHoverThrottled=!0,setTimeout(()=>{this._mouseHoverThrottled=!1},32)}_fireEvent(t,e,i){this._map._fireDOMEvent(e,i||e.type,t)}_bringToFront(t){const e=t._order;if(!e)return;const i=e.next,n=e.prev;if(i)i.prev=n;else return;n?n.next=i:i&&(this._drawFirst=i),e.prev=this._drawLast,this._drawLast.next=e,e.next=void 0,this._drawLast=e,this._requestRedraw(t)}_bringToBack(t){const e=t._order;if(!e)return;const i=e.next,n=e.prev;if(n)n.next=i;else return;i?i.prev=n:n&&(this._drawLast=n),e.prev=void 0,e.next=this._drawFirst,this._drawFirst.prev=e,this._drawFirst=e,this._requestRedraw(t)}}({...Lt});function H(o){return document.createElementNS("http://www.w3.org/2000/svg",o)}function le(o,s){let t="",e,i,n,r,a,h;for(e=0,n=o.length;e<n;e++){for(a=o[e],i=0,r=a.length;i<r;i++)h=a[i],t+=`${(i?"L":"M")+h.x} ${h.y}`;t+=s?"z":""}return t||"M0 0"}class de extends P{constructor(){super(...arguments);l(this,"_svgSize");l(this,"_rootGroup")}_initContainer(){this._container=H("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=H("g"),this._container.appendChild(this._rootGroup)}_destroyContainer(){P.prototype._destroyContainer.call(this),this._svgSize=void 0,this._rootGroup=void 0}_resizeContainer(){const t=P.prototype._resizeContainer.call(this);return(!this._svgSize||!this._svgSize.equals(t))&&(this._svgSize=t,this._container.setAttribute("width",t.x),this._container.setAttribute("height",t.y)),t}_update(){if(this._map._animatingZoom&&this._bounds)return;const t=this._bounds,e=t.getSize();this._container.setAttribute("viewBox",[t.min.x,t.min.y,e.x,e.y].join(" ")),this.fire("update")}_initPath(t){const e=t._path=H("path");t.options.className&&e.classList.add(...E(t.options.className)),t.options.interactive&&e.classList.add("leaflet-interactive"),this._updateStyle(t),this._layers[v(t)]=t}_addPath(t){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(t._path),t.addInteractiveTarget(t._path)}_removePath(t){t._path.remove(),t.removeInteractiveTarget(t._path),delete this._layers[v(t)]}_updatePath(t){t._project(),t._update()}_updateStyle(t){const e=t._path,i=t.options;e&&(i.stroke?(e.setAttribute("stroke",i.color),e.setAttribute("stroke-opacity",i.opacity),e.setAttribute("stroke-width",i.weight),e.setAttribute("stroke-linecap",i.lineCap),e.setAttribute("stroke-linejoin",i.lineJoin),i.dashArray?e.setAttribute("stroke-dasharray",i.dashArray):e.removeAttribute("stroke-dasharray"),i.dashOffset?e.setAttribute("stroke-dashoffset",i.dashOffset):e.removeAttribute("stroke-dashoffset")):e.setAttribute("stroke","none"),i.fill?(e.setAttribute("fill",i.fillColor||i.color),e.setAttribute("fill-opacity",i.fillOpacity),e.setAttribute("fill-rule",i.fillRule||"evenodd")):e.setAttribute("fill","none"))}_updatePoly(t,e){this._setPath(t,le(t._parts,e))}_updateCircle(t){const e=t._point,i=Math.max(Math.round(t._radius),1),n=Math.max(Math.round(t._radiusY),1)||i,r=`a${i},${n} 0 1,0 `,a=t._empty()?"M0 0":`M${e.x-i},${e.y}${r}${i*2},0 ${r}${-i*2},0 `;this._setPath(t,a)}_setPath(t,e){t._path.setAttribute("d",e)}_bringToFront(t){ot(t._path)}_bringToBack(t){rt(t._path)}}class ce extends nt{constructor(t,e){super();l(this,"options");l(this,"_handlers",[]);l(this,"_targets",Object.create(null));l(this,"_layers",{});l(this,"_container");l(this,"_proxy");l(this,"_size");l(this,"_sizeChanged",!0);l(this,"_zoom");l(this,"_zoomAnimated");l(this,"_panAnim");l(this,"_panes",Object.create(null));l(this,"_rootPane");l(this,"_paneRenderers",Object.create(null));l(this,"_lastCenter");l(this,"_loaded",!1);l(this,"_enforcingBounds",!1);l(this,"_resizeFrame",0);l(this,"_flyToFrame",0);l(this,"_tempFireZoomEvent",!1);l(this,"_resizeObserver",new ResizeObserver(this._onResize.bind(this)));l(this,"_sizeTimer");l(this,"_pixelOrigin");l(this,"_animatingZoom",!1);l(this,"_animateToCenter");l(this,"_animateToZoom",0);l(this,"dragging");l(this,"_renderer");l(this,"_mouseEvents",["click","dblclick","mouseover","mouseout","contextmenu"]);const i=this.options={crs:Pt,center:void 0,zoom:void 0,minZoom:0,maxZoom:1/0,layers:[],handlers:Object.create(null),maxBounds:void 0,renderer:void 0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,preferCanvas:!1,...e};this._container=t,this._targets[v(t)]=this,x(t,"scroll",this._onScroll,this);const n=["leaflet-container"];st&&n.push("leaflet-touch"),X&&n.push("leaflet-retina"),jt&&n.push("leaflet-safari"),i.fadeAnimation&&n.push("leaflet-fade-anim"),t.classList.add(...n);const{position:r}=getComputedStyle(t);r!=="absolute"&&r!=="relative"&&r!=="fixed"&&r!=="sticky"&&(t.style.position="relative"),this._rootPane=this.createPane("root",this._container),A(this._rootPane,new c(0,0)),this.createPane("tile"),this.createPane("overlay"),this.createPane("tooltip");const a=this.createPane("marker");i.markerZoomAnimation||a.classList.add("leaflet-zoom-hide"),x(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this._resizeObserver.observe(this._container),i.transform3DLimit&&this.on("moveend",this._onMoveEnd),i.maxBounds&&this.setMaxBounds(i.maxBounds),i.zoom!==void 0&&(this._zoom=this._limitZoom(i.zoom)),i.center&&i.zoom!==void 0&&this.setView(i.center,i.zoom,{reset:!0});for(const[h,d]of Object.entries(i.handlers)){const u=this[h]=new d(this);this._handlers.push(u),u.enable()}this._zoomAnimated=i.zoomAnimationThreshold>0,this._zoomAnimated&&(this._createAnimProxy(),x(this._proxy,"transitionend",this._catchTransitionEnd,this));for(const h of i.layers)this.addLayer(h)}setView(t,e,i={}){var n;return e=e===void 0?this._zoom:this._limitZoom(e),t=this._limitCenter(t,e,this.options.maxBounds),i=i||{},this._stop(),this._loaded&&!i.reset&&i!==!0&&(i.animate!==void 0&&(i.zoom={animate:i.animate,...i.zoom},i.pan={animate:i.animate,duration:i.duration,...i.pan}),this._zoom!==e?this._tryAnimatedZoom(t,e,i.zoom):this._tryAnimatedPan(t,i.pan))?(clearTimeout(this._sizeTimer),this):(this._resetView(t,e,(n=i.pan)==null?void 0:n.noMoveStart),this)}setZoom(t,e){return this._loaded?this.setView(this.getCenter(),t,{zoom:e}):(this._zoom=t,this)}setZoomAround(t,e,i){const n=this.getZoomScale(e),r=this.getSize().divideBy(2),a=t instanceof c?t:this.latLngToContainerPoint(t),h=a.subtract(r).multiplyBy(1-1/n),d=this.containerPointToLatLng(r.add(h));return this.setView(d,e,{zoom:i})}_getBoundsCenterZoom(t,e={}){const i=e.paddingTopLeft||e.padding||new c(0,0),n=e.paddingBottomRight||e.padding||new c(0,0);let r=this.getBoundsZoom(t,!1,i.add(n));if(r=typeof e.maxZoom=="number"?Math.min(e.maxZoom,r):r,r===1/0)return{center:t.getCenter(),zoom:r};const a=n.subtract(i).divideBy(2),h=this.project(t.getSouthWest(),r),d=this.project(t.getNorthEast(),r);return{center:this.unproject(h.add(d).divideBy(2).add(a),r),zoom:r}}fitBounds(t,e){if(!t.isValid())throw new Error("Bounds are not valid.");const i=this._getBoundsCenterZoom(t,e);return this.setView(i.center,i.zoom,e)}fitWorld(t){return this.fitBounds(new L(new f(-90,-180),new f(90,180)),t)}panTo(t,e){return this.setView(t,this._zoom,{pan:e})}panBy(t,e={}){if(t=t.round(),!t.x&&!t.y)return this.fire("moveend");if(e.animate!==!0&&!this.getSize().contains(t))return this._resetView(this.unproject(this.project(this.getCenter()).add(t)),this._zoom),this;if(this._panAnim||(this._panAnim=new ne,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),e.noMoveStart||this.fire("movestart"),e.animate!==!1){this._rootPane.classList.add("leaflet-pan-anim");const i=this._getMapPanePos().subtract(t).round();this._panAnim.run(this._rootPane,i,e.duration||.25,e.easeLinearity)}else this._rawPanBy(t),this.fire("move").fire("moveend");return this}flyTo(t,e,i={}){if(i.animate===!1)return this.setView(t,e,i);this._stop();const n=this.project(this.getCenter()),r=this.project(t),a=this.getSize(),h=this._zoom;e??(e=h);const d=Math.max(a.x,a.y),u=d*this.getZoomScale(h,e),m=r.distanceTo(n)||1,_=1.42,y=_*_;function M(p){const k=p?-1:1,Zt=p?u:d,Bt=u*u-d*d+k*y*y*m*m,Ot=2*Zt*y*m,W=Bt/Ot,lt=Math.sqrt(W*W+1)-W;return lt<1e-9?-18:Math.log(lt)}function O(p){return(Math.exp(p)-Math.exp(-p))/2}function S(p){return(Math.exp(p)+Math.exp(-p))/2}function bt(p){return O(p)/S(p)}const z=M(0);function Mt(p){return d*(S(z)/S(z+_*p))}function zt(p){return d*(S(z)*bt(z+_*p)-O(z))/y}function At(p){return 1-Math.pow(1-p,1.5)}const Et=Date.now(),at=(M(1)-z)/_,Ct=i.duration?1e3*i.duration:1e3*at*.8;function ht(){const p=(Date.now()-Et)/Ct,k=At(p)*at;p<=1?(this._flyToFrame=requestAnimationFrame(ht.bind(this)),this._move(this.unproject(n.add(r.subtract(n).multiplyBy(zt(k)/m)),h),this.getScaleZoom(d/Mt(k),h),{flyTo:!0})):this._move(t,e)._moveEnd(!0)}return this._moveStart(!0,i.noMoveStart),ht.call(this),this}flyToBounds(t,e){const i=this._getBoundsCenterZoom(t,e);return this.flyTo(i.center,i.zoom,e)}setMaxBounds(t){return this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),t.isValid()?(this.options.maxBounds=t,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=void 0,this)}setMinZoom(t){return this._loaded&&t!==this.options.minZoom&&(this.options.minZoom=t,this.fire("zoomlimitschanged"),this._zoom<t&&this.setZoom(t)),this}setMaxZoom(t){return this._loaded&&t!==this.options.maxZoom&&(this.options.maxZoom=t,this.fire("zoomlimitschanged"),this._zoom>t&&this.setZoom(t)),this}panInsideBounds(t,e){this._enforcingBounds=!0;const i=this.getCenter(),n=this._limitCenter(i,this._zoom,t);return i.equals(n)||this.panTo(n,e),this._enforcingBounds=!1,this}panInside(t,e={}){const i=e.paddingTopLeft||e.padding||new c(0,0),n=e.paddingBottomRight||e.padding||new c(0,0),r=this.project(this.getCenter()),a=this.project(t),h=this.getPixelBounds(),d=new g(h.min.add(i),h.max.subtract(n)),u=d.getSize();if(!d.contains(a)){this._enforcingBounds=!0;const m=a.subtract(d.getCenter()),_=d.extend(a).getSize().subtract(u);r.x+=m.x<0?-_.x:_.x,r.y+=m.y<0?-_.y:_.y,this.panTo(this.unproject(r),e),this._enforcingBounds=!1}return this}invalidateSize(t){if(!this._loaded)return this;t=Object.assign({animate:!1,pan:!0},typeof t=="boolean"?{animate:t}:t);const e=this.getSize();this._sizeChanged=!0,this._lastCenter=void 0;const i=this.getSize(),n=e.divideBy(2).round(),r=i.divideBy(2).round(),a=n.subtract(r);return!a.x&&!a.y?this:(t.animate&&t.pan?this.panBy(a):(t.pan&&this._rawPanBy(a),this.fire("move"),t.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(this.fire.bind(this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:e,newSize:i}))}stop(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()}remove(){x(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this._resizeObserver.disconnect(),this.options.transform3DLimit&&this.off("moveend",this._onMoveEnd),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds);try{delete this._container._leaflet_id}catch{this._container._leaflet_id=void 0}this._stop(),this._rootPane.remove(),this._resizeFrame&&(cancelAnimationFrame(this._resizeFrame),this._resizeFrame=0);for(let t=0,e=this._handlers.length;t<e;t++)this._handlers[t].disable();this._loaded&&this.fire("unload");for(const t of Object.values(this._layers))t.remove();for(const t of Object.values(this._panes))t.remove();this._renderer=void 0,this.off()}createPane(t,e=this._rootPane){return this._panes[t]=C("div",`leaflet-pane leaflet-${t}-pane`,e)}getCenter(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())}getBounds(){const t=this.getPixelBounds(),e=this.unproject(t.getBottomLeft()),i=this.unproject(t.getTopRight());return new L(e,i)}getBoundsZoom(t,e,i=new c(0,0)){let n=this._zoom||0;const r=this.options.minZoom,a=this.options.maxZoom,h=t.getNorthWest(),d=t.getSouthEast(),u=this.getSize().subtract(i),m=new g(this.project(d,n),this.project(h,n)).getSize(),_=this.options.zoomSnap,y=u.x/m.x,M=u.y/m.y,O=e?Math.max(y,M):Math.min(y,M);return n=this.getScaleZoom(O,n),_&&(n=Math.round(n/(_/100))*(_/100),n=e?Math.ceil(n/_)*_:Math.floor(n/_)*_),Math.max(r,Math.min(a,n))}getSize(){return(!this._size||this._sizeChanged)&&(this._size=new c(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()}getPixelBounds(t,e){const i=this._getTopLeftPoint(t,e);return new g(i,i.add(this.getSize()))}getPixelOrigin(){return this._checkIfLoaded(),this._pixelOrigin}getPixelWorldBounds(t=this._zoom){return this.options.crs.getProjectedBounds(t)}getZoomScale(t,e=this._zoom){const i=this.options.crs;return e=e===void 0?this._zoom:e,i.scale(t)/i.scale(e)}getScaleZoom(t,e=this._zoom){const i=this.options.crs,n=i.zoom(t*i.scale(e));return isNaN(n)?1/0:n}project(t,e=this._zoom){return this.options.crs.latLngToPoint(t,e)}unproject(t,e=this._zoom){return this.options.crs.pointToLatLng(t,e)}layerPointToLatLng(t){const e=t.add(this.getPixelOrigin());return this.unproject(e)}latLngToLayerPoint(t){return this.project(t)._round()._subtract(this.getPixelOrigin())}wrapLatLng(t){return this.options.crs.wrapLatLng(t)}wrapLatLngBounds(t){return this.options.crs.wrapLatLngBounds(t)}distance(t,e){return this.options.crs.distance(t,e)}containerPointToLayerPoint(t){return t.subtract(this._getMapPanePos())}layerPointToContainerPoint(t){return t.add(this._getMapPanePos())}containerPointToLatLng(t){const e=this.containerPointToLayerPoint(t);return this.layerPointToLatLng(e)}latLngToContainerPoint(t){return this.layerPointToContainerPoint(this.latLngToLayerPoint(t))}mouseEventToContainerPoint(t){return ie(t,this._container)}mouseEventToLayerPoint(t){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(t))}mouseEventToLatLng(t){return this.layerPointToLatLng(this.mouseEventToLayerPoint(t))}_resetView(t,e,i){A(this._rootPane,new c(0,0));const n=!this._loaded;this._loaded=!0,e=this._limitZoom(e),this.fire("viewprereset");const r=this._zoom!==e;this._moveStart(r,i)._move(t,e)._moveEnd(r),this.fire("viewreset"),n&&this.fire("load")}_moveStart(t,e){return t&&this.fire("zoomstart"),e||this.fire("movestart"),this}_move(t,e=this._zoom,i,n){const r=this._zoom!==e;return this._zoom=e,this._lastCenter=t,this._pixelOrigin=this._getNewPixelOrigin(t),n?i!=null&&i.pinch&&this.fire("zoom",i):((r||i!=null&&i.pinch)&&this.fire("zoom",i),this.fire("move",i)),this}_moveEnd(t){return t&&this.fire("zoomend"),this.fire("moveend")}_stop(){return cancelAnimationFrame(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this}_rawPanBy(t){A(this._rootPane,this._getMapPanePos().subtract(t))}_panInsideMaxBounds(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)}_checkIfLoaded(){if(!this._loaded)throw new Error("Set map center and zoom first.")}_onResize(){cancelAnimationFrame(this._resizeFrame),this._resizeFrame=requestAnimationFrame(()=>this.invalidateSize({debounceMoveend:!0}))}_onScroll(){this._container.scrollTop=0,this._container.scrollLeft=0}_onMoveEnd(){const t=this._getMapPanePos();Math.max(Math.abs(t.x),Math.abs(t.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this._zoom)}_findEventTargets(t,e){let i=[],n,r=t.target||t.srcElement,a=!1;const h=e==="mouseout"||e==="mouseover";for(;r;){if(n=this._targets[v(r)],n&&(e==="click"||e==="preclick")&&this._draggableMoved(n)){a=!0;break}if(n&&n.listens(e,!0)&&(h&&!yt(r,t)||(i.push(n),h))||r===this._container)break;r=r.parentNode}return!i.length&&!a&&!h&&this.listens(e,!0)&&(i=[this]),i}_isClickDisabled(t){for(;t&&t!==this._container;){if(t._leaflet_disable_click)return!0;t=t.parentNode}return!1}_handleDOMEvent(t){const e=t.target||t.srcElement;if(!this._loaded||e._leaflet_disable_events||t.type==="click"&&this._isClickDisabled(e))return;const i=t.type;i==="mousedown"&&se(e),this._fireDOMEvent(t,i)}_fireDOMEvent(t,e,i){if(t.type==="click"){const h={...t};h.type="preclick",this._fireDOMEvent(h,h.type,i)}let n=this._findEventTargets(t,e);if(i){const h=[];for(let d=0;d<i.length;d++)i[d].listens(e,!0)&&h.push(i[d]);n=h.concat(n)}if(!n.length)return;e==="contextmenu"&&ee(t);const r=n[0],a={originalEvent:t};if(t.type!=="keypress"&&t.type!=="keydown"&&t.type!=="keyup"){const h=r.getLatLng&&(!r._radius||r._radius<=10);a.containerPoint=h?this.latLngToContainerPoint(r.getLatLng()):this.mouseEventToContainerPoint(t),a.layerPoint=this.containerPointToLayerPoint(a.containerPoint),a.latlng=h?r.getLatLng():this.layerPointToLatLng(a.layerPoint)}for(let h=0;h<n.length;h++)if(n[h].fire(e,a,!0),a.originalEvent._stopped||n[h].options.bubblingMouseEvents===!1&&this._mouseEvents.includes(e))return}_draggableMoved(t){var e,i,n;return t=(e=t.dragging)!=null&&e.enabled()?t:this,((i=t.dragging)==null?void 0:i.moved())||!!((n=this.boxZoom)!=null&&n._moved)}whenReady(t,e=this){return this._loaded?t.call(e,{target:this}):this.on("load",t,e),this}_getMapPanePos(){return xt(this._rootPane)}_moved(){const t=this._getMapPanePos();return t.x!==0||t.y!==0}_getTopLeftPoint(t,e){return(t&&e!==void 0?this._getNewPixelOrigin(t,e):this.getPixelOrigin()).subtract(this._getMapPanePos())}_getNewPixelOrigin(t,e){const i=this.getSize()._divideBy(2);return this.project(t,e)._subtract(i)._add(this._getMapPanePos())._round()}_latLngToNewLayerPoint(t,e,i){const n=this._getNewPixelOrigin(i,e);return this.project(t,e)._subtract(n)}_latLngBoundsToNewLayerBounds(t,e,i){const n=this._getNewPixelOrigin(i,e);return new g(this.project(t.getSouthWest(),e)._subtract(n),this.project(t.getNorthWest(),e)._subtract(n),this.project(t.getSouthEast(),e)._subtract(n),this.project(t.getNorthEast(),e)._subtract(n))}_getCenterLayerPoint(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))}_getCenterOffset(t){return this.latLngToLayerPoint(t).subtract(this._getCenterLayerPoint())}_limitCenter(t,e,i){if(!i)return t;const n=this.project(t,e),r=this.getSize().divideBy(2),a=new g(n.subtract(r),n.add(r)),h=this._getBoundsOffset(a,i,e);return Math.abs(h.x)<=1&&Math.abs(h.y)<=1?t:this.unproject(n.add(h),e)}_limitOffset(t,e){if(!e)return t;const i=this.getPixelBounds(),n=new g(i.min.add(t),i.max.add(t));return t.add(this._getBoundsOffset(n,e))}_getBoundsOffset(t,e,i){const n=new g(this.project(e.getNorthEast(),i),this.project(e.getSouthWest(),i)),r=n.min.subtract(t.min),a=n.max.subtract(t.max),h=this._rebound(r.x,-a.x),d=this._rebound(r.y,-a.y);return new c(h,d)}_rebound(t,e){return t+e>0?Math.round(t-e)/2:Math.max(0,Math.ceil(t))-Math.max(0,Math.floor(e))}_limitZoom(t){const{minZoom:e,maxZoom:i,zoomSnap:n}=this.options;return n&&(t=Math.round(t/n)*n),Math.max(e,Math.min(i,t))}_onPanTransitionStep(){this.fire("move")}_onPanTransitionEnd(){this._rootPane.classList.remove("leaflet-pan-anim"),this.fire("moveend")}_tryAnimatedPan(t,e){const i=this._getCenterOffset(t)._trunc();return(e==null?void 0:e.animate)!==!0&&!this.getSize().contains(i)?!1:(this.panBy(i,e),!0)}_createAnimProxy(){const t=C("div","leaflet-proxy leaflet-zoom-animated");this._proxy=t,this._rootPane.appendChild(t),this.on("zoomanim",function(e){const i=this._proxy.style.transform;B(this._proxy,this.project(e.center,e.zoom),this.getZoomScale(e.zoom,1)),i===this._proxy.style.transform&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)}_destroyAnimProxy(){var t;(t=this._proxy)==null||t.remove(),this.off("load moveend",this._animMoveEnd,this),this._proxy=void 0}_animMoveEnd(){if(this._proxy){const t=this.getCenter(),e=this._zoom;B(this._proxy,this.project(t,e),this.getZoomScale(e,1))}}_catchTransitionEnd(t){this._animatingZoom&&t.propertyName.includes("transform")&&this._onZoomTransitionEnd()}_nothingToAnimate(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length}_tryAnimatedZoom(t,e,i={}){if(this._animatingZoom)return!0;if(!this._zoomAnimated||i.animate===!1||this._nothingToAnimate()||Math.abs(e-this._zoom)>this.options.zoomAnimationThreshold)return!1;const n=this.getZoomScale(e),r=this._getCenterOffset(t)._divideBy(1-1/n);return i.animate!==!0&&!this.getSize().contains(r)?!1:(requestAnimationFrame(()=>{this._moveStart(!0,i.noMoveStart??!1)._animateZoom(t,e,!0)}),!0)}_animateZoom(t,e,i,n){this._rootPane&&(i&&(this._animatingZoom=!0,this._animateToCenter=t,this._animateToZoom=e,this._rootPane.classList.add("leaflet-zoom-anim")),this.fire("zoomanim",{center:t,zoom:e,noUpdate:n}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(this._onZoomTransitionEnd.bind(this),250))}_onZoomTransitionEnd(){this._animatingZoom&&(this._rootPane&&this._rootPane.classList.remove("leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&(this.fire("zoom"),this._tempFireZoomEvent=!1),this.fire("move"),this._moveEnd(!0))}addLayer(t){var i;const e=v(t);return e in this._layers?this:(this._layers[e]=t,t._mapToAdd=this,(i=t.beforeAdd)==null||i.call(t,this),this.whenReady(t._layerAdd,t),this)}removeLayer(t){var i;const e=v(t);return this._layers[e]?(this._loaded&&((i=t.onRemove)==null||i.call(t,this)),delete this._layers[e],this._loaded&&(this.fire("layerremove",{layer:t}),t.fire("remove")),t._map=void 0,t._mapToAdd=void 0,this):this}hasLayer(t){return v(t)in this._layers}getRenderer(t){const e=t.options.renderer||this._getPaneRenderer(t.options.pane)||this.options.renderer||this._renderer||(this._renderer=this._createRenderer());return this.addLayer(e),e}_getPaneRenderer(t){var e;if(t!=="overlay")return(e=this._paneRenderers)[t]||(e[t]=this._createRenderer({pane:t}))}_createRenderer(t){return this.options.preferCanvas?new he(t):new de(t)}}class U extends D{constructor(t){super();l(this,"_container");l(this,"_tileZoom");l(this,"_levels",{});l(this,"_tiles",{});l(this,"_onOpaqueTile",w);l(this,"_onUpdateLevel",w);l(this,"_onRemoveLevel",w);l(this,"_onCreateLevel",w);l(this,"_noPrune",!1);l(this,"_loading",!1);l(this,"_onMove");l(this,"_fadeFrame",0);l(this,"_globalTileRange");l(this,"_level");l(this,"_wrapX");l(this,"_wrapY");b(this,t,{tileSize:256,opacity:1,updateWhenIdle:It,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:void 0,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tile",className:"",keepBuffer:2})}onAdd(t){return this._initContainer(),this._levels={},this._tiles={},this._resetView(),this}onRemove(t){this._removeAllTiles(),this._container.remove(),this._container=void 0,this._tileZoom=void 0}bringToFront(){return this._map&&(ot(this._container),this._setAutoZIndex(Math.max)),this}bringToBack(){return this._map&&(rt(this._container),this._setAutoZIndex(Math.min)),this}getContainer(){return this._container}setOpacity(t){return this.options.opacity=t,this._updateOpacity(),this}setZIndex(t){return this.options.zIndex=t,this._updateZIndex(),this}isLoading(){return this._loading}redraw(){if(this._map){this._removeAllTiles();const t=this._clampZoom(this._map._zoom);t!==this._tileZoom&&(this._tileZoom=t,this._updateLevels()),this._update()}return this}getEvents(){const t={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=Nt(this._onMoveEnd,this.options.updateInterval,this)),t.move=this._onMove),this._zoomAnimated&&(t.zoomanim=this._animateZoom),t}getTileSize(){const t=this.options.tileSize;return t instanceof c?t:new c(t,t)}_updateZIndex(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)}_setAutoZIndex(t){const e=this.getPane().children;let i=-t(-1/0,1/0);for(let n=0,r=e.length,a;n<r;n++)a=e[n].style.zIndex,e[n]!==this._container&&a&&(i=t(i,+a));isFinite(i)&&(this.options.zIndex=i+t(-1,1),this._updateZIndex())}_updateOpacity(){if(!this._map)return;this._container.style.opacity=this.options.opacity;const t=Date.now();let e=!1,i=!1;for(const n of Object.values(this._tiles)){if(!n.current||!n.loaded)continue;const r=Math.min(1,(t-n.loaded)/200);n.el.style.opacity=r,r<1?e=!0:(n.active?i=!0:this._onOpaqueTile(n),n.active=!0)}i&&!this._noPrune&&this._pruneTiles(),e&&(cancelAnimationFrame(this._fadeFrame),this._fadeFrame=requestAnimationFrame(()=>this._updateOpacity()))}_initContainer(){this._container||(this._container=C("div",`leaflet-layer ${this.options.className||""}`),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))}_updateLevels(){const t=this._tileZoom,e=this.options.maxZoom;if(t===void 0)return;for(let[r,a]of Object.entries(this._levels)){const h=Number(r);a.el.children.length||h===t?(a.el.style.zIndex=e-Math.abs(t-h),this._onUpdateLevel(h)):(a.el.remove(),this._removeTilesAtZoom(h),this._onRemoveLevel(h),delete this._levels[h])}let i=this._levels[t];const n=this._map;return i||(i=this._levels[t]={el:C("div","leaflet-tile-container leaflet-zoom-animated",this._container),origin:n.project(n.unproject(n.getPixelOrigin()),t).round(),zoom:t},i.el.style.zIndex=e,this._setZoomTransform(i,n.getCenter(),n._zoom),w(i.el.offsetWidth),this._onCreateLevel(i)),this._level=i,i}_pruneTiles(){if(!this._map)return;const t=this._map._zoom;if(t>this.options.maxZoom||t<this.options.minZoom){this._removeAllTiles();return}for(const e of Object.values(this._tiles))e.retain=e.current;for(const e of Object.values(this._tiles))if(e.current&&!e.active){const i=e.coords;this._retainParent(i.x,i.y,i.z,i.z-5)||this._retainChildren(i.x,i.y,i.z,i.z+2)}for(const[e,i]of Object.entries(this._tiles))i.retain||this._removeTile(e)}_removeTilesAtZoom(t){for(const e in this._tiles)this._tiles[e].coords.z===t&&this._removeTile(e)}_removeAllTiles(){for(const t of Object.keys(this._tiles))this._removeTile(t)}_invalidateAll(){for(const[t,e]of Object.entries(this._levels))e.el.remove(),this._onRemoveLevel(Number(t)),delete this._levels[t];this._removeAllTiles(),this._tileZoom=void 0}_retainParent(t,e,i,n){const r=Math.floor(t/2),a=Math.floor(e/2),h=i-1,d=new c(+r,+a);d.z=+h;const u=this._tileCoordsToKey(d),m=this._tiles[u];return m&&m.active?(m.retain=!0,!0):(m&&m.loaded&&(m.retain=!0),h>n?this._retainParent(r,a,h,n):!1)}_retainChildren(t,e,i,n){for(let r=2*t;r<2*t+2;r++)for(let a=2*e;a<2*e+2;a++){const h=new c(r,a);h.z=i+1;const d=this._tileCoordsToKey(h),u=this._tiles[d];if(u&&u.active){u.retain=!0;continue}else u&&u.loaded&&(u.retain=!0);i+1<n&&this._retainChildren(r,a,i+1,n)}}_resetView(t){const e=t&&(t.pinch||t.flyTo);this._setView(this._map.getCenter(),this._map._zoom,e,e)}_animateZoom(t){this._setView(t.center,t.zoom,!0,t.noUpdate)}_clampZoom(t){const e=this.options;return e.minNativeZoom!==void 0&&t<e.minNativeZoom?e.minNativeZoom:e.maxNativeZoom!==void 0&&e.maxNativeZoom<t?e.maxNativeZoom:t}_setView(t,e,i,n){let r=Math.round(e);this.options.maxZoom!==void 0&&r>this.options.maxZoom||this.options.minZoom!==void 0&&r<this.options.minZoom?r=void 0:r=this._clampZoom(r);const a=this.options.updateWhenZooming&&r!==this._tileZoom;(!n||a)&&(this._tileZoom=r,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),r!==void 0&&this._update(t),i||this._pruneTiles(),this._noPrune=!!i),this._setZoomTransforms(t,e)}_setZoomTransforms(t,e){for(const i of Object.values(this._levels))this._setZoomTransform(i,t,e)}_setZoomTransform(t,e,i){const n=this._map.getZoomScale(i,t.zoom),r=t.origin.multiplyBy(n).subtract(this._map._getNewPixelOrigin(e,i)).round();B(t.el,r,n)}_resetGrid(){const t=this._map,e=t.options.crs,i=this.getTileSize(),n=this._tileZoom,r=t.getPixelWorldBounds(this._tileZoom);r&&(this._globalTileRange=this._pxBoundsToTileRange(r)),this._wrapX=e.wrapLng&&!this.options.noWrap&&[Math.floor(t.project(new f(0,e.wrapLng[0]),n).x/i.x),Math.ceil(t.project(new f(0,e.wrapLng[1]),n).x/i.y)],this._wrapY=e.wrapLat&&!this.options.noWrap&&[Math.floor(t.project(new f(e.wrapLat[0],0),n).y/i.x),Math.ceil(t.project(new f(e.wrapLat[1],0),n).y/i.y)]}_onMoveEnd(){!this._map||this._map._animatingZoom||this._update()}_getTiledPixelBounds(t){const e=this._map,i=e._animatingZoom?Math.max(e._animateToZoom,e._zoom):e._zoom,n=e.getZoomScale(i,this._tileZoom),r=e.project(t,this._tileZoom).floor(),a=e.getSize().divideBy(n*2);return new g(r.subtract(a),r.add(a))}_update(t){const e=this._map;if(!e)return;const i=this._clampZoom(e._zoom);if(t||(t=e.getCenter()),this._tileZoom===void 0)return;const n=this._getTiledPixelBounds(t),r=this._pxBoundsToTileRange(n),a=r.getCenter(),h=[],d=this.options.keepBuffer,u=new g(r.getBottomLeft().subtract(new c(d,-d)),r.getTopRight().add(new c(d,-d)));if(!(isFinite(r.min.x)&&isFinite(r.min.y)&&isFinite(r.max.x)&&isFinite(r.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(const m of Object.values(this._tiles)){const _=m.coords;(_.z!==this._tileZoom||!u.contains(new c(_.x,_.y)))&&(m.current=!1)}if(Math.abs(i-this._tileZoom)>1){this._setView(t,i);return}for(let m=r.min.y;m<=r.max.y;m++)for(let _=r.min.x;_<=r.max.x;_++){const y=new c(_,m);if(y.z=this._tileZoom,!this._isValidTile(y))continue;const M=this._tiles[this._tileCoordsToKey(y)];M?M.current=!0:h.push(y)}if(h.sort((m,_)=>m.distanceTo(a)-_.distanceTo(a)),h.length!==0){this._loading||(this._loading=!0,this.fire("loading"));const m=document.createDocumentFragment();for(let _=0;_<h.length;_++)this._addTile(h[_],m);this._level.el.appendChild(m)}}_isValidTile(t){const e=this._map.options.crs;if(!e.infinite){const n=this._globalTileRange;if(!e.wrapLng&&(t.x<n.min.x||t.x>n.max.x)||!e.wrapLat&&(t.y<n.min.y||t.y>n.max.y))return!1}if(!this.options.bounds)return!0;const i=this._tileCoordsToBounds(t);return this.options.bounds.overlaps(i)}_keyToBounds(t){return this._tileCoordsToBounds(this._keyToTileCoords(t))}_tileCoordsToNwSe(t){const e=this._map,i=this.getTileSize(),n=t.scaleBy(i),r=n.add(i),a=e.unproject(n,t.z),h=e.unproject(r,t.z);return[a,h]}_tileCoordsToBounds(t){const e=this._tileCoordsToNwSe(t);let i=new L(e[0],e[1]);return this.options.noWrap||(i=this._map.wrapLatLngBounds(i)),i}_tileCoordsToKey(t){return`${t.x}:${t.y}:${t.z}`}_keyToTileCoords(t){const[e,i,n]=t.split(":"),r=new c(+e,+i);return r.z=+n,r}_removeTile(t){const e=this._tiles[t];e&&(e.el.remove(),delete this._tiles[t],this.fire("tileunload",{tile:e.el,coords:this._keyToTileCoords(t)}))}_initTile(t){const e=this.getTileSize();t.classList.add("leaflet-tile"),t.style.width=`${e.x}px`,t.style.height=`${e.y}px`,t.onselectstart=w,t.onmousemove=w}_addTile(t,e){const i=this._getTilePos(t),n=this._tileCoordsToKey(t),r=this.createTile(this._wrapCoords(t),this._tileReady.bind(this,t));this._initTile(r),this.createTile.length<2&&requestAnimationFrame(()=>this._tileReady(t,null,r)),A(r,i),this._tiles[n]={el:r,coords:t,current:!0,loaded:0,active:!1,retain:!1},e.appendChild(r),this.fire("tileloadstart",{tile:r,coords:t})}_tileReady(t,e,i){e&&this.fire("tileerror",{error:e,tile:i,coords:t});const n=this._tileCoordsToKey(t),r=this._tiles[n];r&&(r.loaded=Date.now(),this._map.options.fadeAnimation?(r.el.style.opacity=0,cancelAnimationFrame(this._fadeFrame),this._fadeFrame=requestAnimationFrame(()=>this._updateOpacity())):(r.active=!0,this._pruneTiles()),e||(r.el.classList.add("leaflet-tile-loaded"),this.fire("tileload",{tile:r.el,coords:t})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),this._map.options.fadeAnimation?setTimeout(this._pruneTiles.bind(this),250):requestAnimationFrame(()=>this._pruneTiles())))}_getTilePos(t){return t.scaleBy(this.getTileSize()).subtract(this._level.origin)}_wrapCoords(t){const e=new c(this._wrapX?F(t.x,this._wrapX):t.x,this._wrapY?F(t.y,this._wrapY):t.y);return e.z=t.z,e}_pxBoundsToTileRange(t){const e=this.getTileSize();return new g(t.min.unscaleBy(e).floor(),t.max.unscaleBy(e).ceil().subtract(new c(1,1)))}_noTilesToLoad(){return Object.values(this._tiles).every(t=>t.loaded)}}class ue extends U{constructor(s,t){super(t),this._url=s;const e=b(this,t,{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:void 0,referrerPolicy:void 0});e.detectRetina&&X&&e.maxZoom>0?(e.tileSize=Math.floor(e.tileSize/2),e.zoomReverse?(e.zoomOffset--,e.minZoom=Math.min(e.maxZoom,e.minZoom+1)):(e.zoomOffset++,e.maxZoom=Math.max(e.minZoom,e.maxZoom-1)),e.minZoom=Math.max(0,e.minZoom)):e.zoomReverse?e.minZoom=Math.min(e.maxZoom,e.minZoom):e.maxZoom=Math.max(e.minZoom,e.maxZoom),typeof e.subdomains=="string"&&(e.subdomains=e.subdomains.split("")),this.on("tileunload",this._onTileRemove)}setUrl(s,t){return this._url===s&&t===void 0&&(t=!0),this._url=s,t||this.redraw(),this}createTile(s,t){const e=document.createElement("img");return x(e,"load",this._tileOnLoad.bind(this,t,e)),x(e,"error",this._tileOnError.bind(this,t,e)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(e.crossOrigin=this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(e.referrerPolicy=this.options.referrerPolicy),e.alt="",e.src=this.getTileUrl(s),e}getTileUrl(s){const t={r:X?"@2x":"",s:this._getSubdomain(s),x:s.x,y:s.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){const e=this._globalTileRange.max.y-s.y;this.options.tms&&(t.y=e),t["-y"]=e}return Wt(this._url,Object.assign(t,this.options))}_tileOnLoad(s,t){s(null,t)}_tileOnError(s,t,e){const i=this.options.errorTileUrl;i&&t.src!==i&&(t.src=i),s(e,t)}_onTileRemove(s){s.tile.onload=null}_getZoomForUrl(){let s=this._tileZoom;const{maxZoom:t,zoomReverse:e,zoomOffset:i}=this.options;return e&&(s=t-s),s+i}_getSubdomain(s){const t=Math.abs(s.x+s.y)%this.options.subdomains.length;return this.options.subdomains[t]}_abortLoading(){let s,t;for(s in this._tiles)if(this._tiles[s].coords.z!==this._tileZoom&&(t=this._tiles[s].el,t.onload=w,t.onerror=w,!t.complete)){t.src=q;const e=this._tiles[s].coords;t.remove(),delete this._tiles[s],this.fire("tileabort",{tile:t,coords:e})}}_removeTile(s){const t=this._tiles[s];if(t)return t.el.setAttribute("src",q),U.prototype._removeTile.call(this,s)}_tileReady(s,t,e){if(!(!this._map||e&&e.src===q))return U.prototype._tileReady.call(this,s,t,e)}}new ce(document.body,{layers:[new ue("https://tile.openstreetmap.org/{z}/{x}/{y}.png")]}).setView(new f(51.505,-.09),13);
